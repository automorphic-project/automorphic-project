\input{preamble}

% OK, start here.
%
\begin{document}

\title{Representations of compact groups}


\maketitle

\phantomsection
\label{section-phantom}


\tableofcontents


The (complex) representation theory of compact groups, in a nutshell:
\begin{enumerate}
 \item All representations are unitarizable, by averaging an inner product against Haar measure.
 \item All unitary representations decompose into (Hilbert space, i.e., orthogonal and completed) direct sums of finite-dimensional irreducibles (the Peter--Weyl theorem), because operators of convolution by continuous measures are Hilbert--Schmidt (hence compact).
\end{enumerate}


In this chapter, $G$ (or $H$) is a compact group, and we fix throughout the probability Haar measure $dg$. Multiplication of functions by $dg$ turns them into measures which can act on the space of a representation $\pi$, and we feel free to write $\pi(f)$ for $\pi(f dg)$. 


\section{Unitarity}
\label{section-unitarity}

\begin{proposition}
\label{proposition-compact-unitarizable}
 Let $(\pi,V)$ be a representation of $G$ on a space admitting an inner product (positive definite hermitian form). Then, it is unitarizable.
\end{proposition}

\begin{proof}
 Take any positive definite hermitian form $\left< \, , \,\right>'$, and integrate it over the action of the group in order to make it invariant:
 $$ \left<  v, v\right>:= \int_G \left< \pi(g) v, \pi(g) v\right>' dg.$$
\end{proof}

\section{Hilbert--Schmidt property of continuous convolution operators}
\label{section-Hilbert-Schmidt}

Given a Hilbert space $V$, its linear dual $V^*$ is identified with its complex conjugate $\bar V$. We denote by $B(V)=\text{End}(V)$ the space of bounded linear operators on $V$, and by $\hat\otimes$ the Hilbert space tensor product of two Hilbert spaces, i.e., the completion of the algebraic tensor product with respect to the Hilbert norm characterized by $\Vert v \otimes w\Vert = \Vert v\Vert\cdot \Vert w \Vert$.

There is a natural embedding $\bar V\hat\otimes V \hookrightarrow B(V)$, with $\bar v_1 \otimes v_2$ mapping 
to the operator 
$ w\mapsto \left<v_1, w\right> \cdot v_2$.
(Let us take inner products to be complex-linear in the second variable.) The image is the space of {\it Hilbert--Schmidt operators}, and the Hilbert norm on $\bar V\hat\otimes V$ is called the Hilbert--Schmidt norm of an operator. Explicitly:
$$\Vert T\Vert_{HS}^2 = \sum_i \Vert Te_i\Vert^2,$$
where $e_i$ runs over an orthonormal basis of $V$. 

Hilbert--Schmidt operators are {\it compact}: they map bounded sets to precompact sets. 


\begin{proposition}
\label{proposition-continuousconvolution-compact}
 Let $L$ (resp.\ $R$) denote the left (resp.\ right) regular representation of $G$ on $L^2(G)$. For every continuous measure $\mu$ on $G$ the operator $L(\mu)$ (resp.\ $R(\mu)$) is Hilbert--Schmidt and, hence, compact.
\end{proposition}

Recall that we call a measure ``continuous'' if it is the product of a continuous function by Haar measure, see Section \ref{representationtheory-section-measures}.

\begin{proof}
 Let $\mu=h dg$. Then the operator $L(\mu)$ has the integral expression:
$$ L(\mu)(f)(x) = \int_{H} K_h(x,y) f(y) dy,$$
where the kernel is given by:
$$ K_h(x,y) = h(xy^{-1}).$$

The Hilbert--Schmidt norm of an integral operator $T$ with kernel $K$ on a measure space $(X,dx)$ is given by:
$$ \Vert T\Vert_{HS}^2= \Vert K\Vert^2_{L^2(X\times X)}.$$
In particular, $L(\mu)$ is Hilbert--Schmidt. (It was important here that the group was compact for the $L^2$-norm of $K_h$ to be finite.) 
\end{proof}



\section{Recollection of spectral theorems}
\label{section-recollection-spectraltheorems}

We recall the following spectral theorems from functional analysis. 

Let $V$ be a Hilbert space. The \emph{adjoint} of a (bounded) operator $T$ on $V$ is the operator $T^*$ with $\left<  T^*v,w\right>=\left<  v,Tw\right>$. An operator $T$ is called \emph{normal} if $T^* T = T T^*$, and \emph{self-adjoint} if $T=T^*$. The \emph{spectrum} $\sigma(T)$ of an operator $T$ is the (closed) subset of all $\lambda\in \mathbb C$ such that $T-\lambda I$ is not invertible. 

The idea of the spectral theorem is that the space $V$ decomposes as an ``integral'' of ``eigenspaces'' of $T$. A familiar case of an integral of eigenspaces is when $V=L^2(\mathbb R)$, in which case the theory of Fourier transform says:
$$V= \int_{i\mathbb R} \left< e^{sx}\right> ds,$$
with the spaces $\left< e^{sx}\right>$ being eigenspaces for all translation operators. 

\begin{theorem}[Spectral theorem for normal operators]
\label{theorem-spectraltheorem-normal}
 If $T$ is a normal operator on a Hilbert space $V$ then there is a measure space $(X,\mathcal B,\mu)$, a measurable function $\lambda: X\to \mathbb C$ and a unitary isomorphism: $V \simeq L^2(X,\mu)$ which carries the operator $T$ to ``multiplication by $\lambda$''.
 
 Moreover, for every measurable $\omega\subset \mathbb C$, let $E(\omega)$ be the projection (restriction) $L^2(X,\mu) \to L^2(\lambda^{-1}(\omega),\mu)$. Then, $E(\sigma(T))=I$, $E(\omega)\ne 0$ for every relatively open nonempty subset of $\sigma(T)$, and $E(\omega)$ commutes with the commutator of $T$ in $B(V)$.
\end{theorem}

\begin{proof}
 See \cite[Theorem 12.23]{Rudin}. The measure space $(X,\mu)$ in our formulation is not canonical, but can be obtained from the more canonical formulation of \emph{loc.cit}.\ by considering subspaces of $V$ of the form $\overline{\mathbb C[T]v}$, for $v\in V$. 
\end{proof}


An operator on a Banach space is \emph{compact} if it maps bounded sets to precompact sets (i.e.\ sets whose closure is compact). Compact operators form a closed Banach subalgebra $K(V)$ of the algebra of bounded operators $B(V)$, and for a large class of Banach spaces, that includes Hilbert spaces, $K(V)$ is the closure of the set $V^*\otimes V$ of operators with finite-dimensional range, i.e., compact operators are those that can be approximated in the operator norm by operators with finite-dimensional range. 

\begin{theorem}[Spectral theorem for compact self-adjoint operators]
\label{theorem-spectraltheorem-compact} 
 Let $T$ be a compact self-adjoint operator on a Hilbert space $V$, then there is a sequence of eigenvectors $v_n$ with (real) eigenvalues $0\ne\lambda_n\to 0$ (or a finite number of such eigenvalues, if the operator is of finite range) such that 
 $$V = \ker T \oplus \hat{\bigoplus}_n \left< v_n\right>,$$
a Hilbert space (i.e., orthogonal and completed) direct sum. 
\end{theorem}

\begin{proof}
 See \cite[Theorem 12.30]{Rudin}.
\end{proof}


In particular, all eigenspaces with nonzero eigenvalues are finite-dimensional.


\begin{theorem}[Schur's lemma]
\label{theorem-Schurslemma}
 If $V$ is an irreducible unitary representation of any group $G$, and $S\in \text{End}^G(V)$, then $S$ is a scalar multiple of the identity.
 
 If $V, V'$ are two irreducible unitary representations of a group $G$, and $T \in \Hom^G(V,V')$, then $T$ is a scalar multiple of an isometry. 
\end{theorem}

\begin{proof}
 For the first claim, by unitarity, the Hilbert space adjoint $S^*$ of $S$ also commutes with $G$; hence, we may assume that $S$ is self-adjoint, by replacing it with $S+S^*$ and $i(S-S^*)$. Then, we claim that the spectrum $\sigma(S)$ is a singleton, making $S$ a scalar operator by the Spectral Theorem \ref{theorem-spectraltheorem-normal}. Otherwise, by the same theorem, for two non-empty, disjoint open subsets of $\sigma(S)$, the corresponding projections $E(\omega_1)$ and $E(\omega_2)$ are non-zero, and have orthogonal images. But these projections commute with the action of $G$, which commutes with $S$, hence $V$ cannot be irreducible.
 

 For the second claim, it is enough to show that the self-adjoint bounded operators $T^* T$ and $T T^*$ are scalars. Again, by unitarity, the Hilbert space adjoint $T^*$ of $T$ also commutes with $G$. Let $S$ be one of these operators, and apply the first claim.
 \end{proof}



\section{Peter--Weyl theorems} 
\label{section-PeterWeyl}

Let $H$ be a compact group, and consider the space $V=L^2(H)$. It is a unitary representation for $G=H\times H$. 

Let $(\pi, V)$ be a finite-dimensional representation of $H$, and consider the matrix coefficient map (see \ref{representationtheory-section-matrixcoefficients})
$$ M_\pi: \pi^*\otimes \pi \to C(H).$$

\begin{lemma}
\label{lemma-matrixcoefficient}
For $\pi$ irreducible, the matrix coefficient map is an embedding. For $\pi, \sigma$ irreducible and non-isomorphic, the images of their matrix coefficient maps are orthogonal in $L^2(H)$.
\end{lemma}

\begin{proof}
 The matrix coefficient map is an embedding (injection), because it is clearly non-zero, and $\pi^*\otimes\pi$ is an irreducible representation of $G=H\times H$.
 
 If $\pi, \sigma$ are irreducible and non-isomorphic, the orthogonal projection from the image of $M_\pi$ to the image of $M_\sigma$ is $G$-equivariant, and since $\pi^*\otimes \pi$ is not isomorphic to $\sigma^*\otimes \sigma$ (already as an $1\times H$-representation), it has to be zero.
\end{proof}


Notice that the image of the matrix coefficient map consists of \emph{(left and right) finite} vectors (since $\pi\otimes\pi^*$ is finite dimensional). Our goal is to prove:

\begin{theorem}[Peter--Weyl theorem]
\label{theorem-PeterWeyl}
The matrix coefficient maps give rise to a canonical isomorphism
\begin{equation}
 \label{equation-PeterWeyl}
 L^2(H)\simeq \hat\bigoplus \pi^*\otimes \pi
\end{equation}
(orthogonal, completed direct sum),
where $\pi$ runs over representatives for the isomorphism classes of irreducible, finite dimensional representations of $H$.
\end{theorem}


\begin{proof}
We start with the following assertions:  

\begin{itemize}
 \item Let $\mu_n$ be a sequence of positive probability measures on $G$, supported on a fixed compact neighborhood of the identity,  which converge to $\delta_1$ in the weak-* topology of $M_c(G)$; we will refer to such a sequence as an approximation of the identity. Then, for any Banach representation $(\pi,V)$ and vector $v\in V$ we have $\pi(\mu_n)v\to v$.
 
 This follows from Proposition \ref{representationtheory-proposition-integral-Banach}.
 
 
 \item For any subrepresentation $V$ of $L^2(H)$ under the right (or left) regular action, continuous functions are dense in $V$. 

Indeed, it is enough to choose an approximation $(\mu_n)_n$ of the identity by continuous measures (i.e., continuous functions times a Haar measure). By the above, $L(\mu_n)(f)\to f$ for every $f\in V$, but $L(\mu_n)(f)$ is simply the convolution $\mu_n\star f$, which is continuous. Thus, continuous functions are dense. 

\item Right-finite (or left-finite) functions are dense in any closed, invariant subspace of $L^2(H)$. 

This is the most important step of the proof. Assume to the contrary that there is a non-zero closed subspace $V$ without a dense subspace of right-finite functions, which (by taking orthogonal complement of the subspace of right-finite functions) reduces to the case where $V$ does not have any right-finite vectors. We can find a continuous, self-adjoint measure $\mu$ on $H$ such that $L(\mu)V\ne 0$. Here, by self-adjoint we mean that the operator $L(\mu)$ is self-adjoint, which is equivalent to $h(g^{-1})=\overline{h(g)}$ if $\mu=hdg$ --- exercise! The existence of such a measure follows by approximating the identity by positive, continuous self-adjoint measures $\mu_n$, and then using the fact that $\mu_n(v)\to v$ for every vector $v$.  We know (Proposition \ref{proposition-continuousconvolution-compact}) that $L(\mu)$ is compact, hence by the Spectral Theorem \ref{theorem-spectraltheorem-compact} there is a non-zero (real) eigenvalue $\lambda$ of $L(\mu)$, and the $\lambda$-eigenspace is finite-dimensional. But the $\lambda$-eigenspace for $L(\mu)$ is stable under the right action of $H$, hence there are right-finite vectors, a contradiction.

\end{itemize}

Now let $\pi$ be a finite-dimensional irreducible representation of $H$; by the previous point, such representations exist. We have a tautological map $T:\text{Hom}^H(\pi, L^2(H)) \otimes \pi\to L^2(H)$, where we only consider the right regular representation. Moreover, the image of $T$ lies in the subspace $C(H)$ of continuous functions. If we endow the space $\text{Hom}^H(\pi, L^2(H))$ with the action induced from the left regular representation of $H$ on $L^2(H)$, the map $T$ is equivariant. Evaluation at the identity defines a morphism $\text{Hom}(\pi, L^2(H)) \to \pi^*$, whose kernel is (tautologically) trivial. We conclude that the $\pi$-isotypic component of $L^2(H)$ under the right representation (the image of $T$) is isomorphic to $\pi^*\otimes \pi$. Those subspaces, as the isomorphism class of $\pi$ varies, are mutually orthogonal by Lemma \ref{lemma-matrixcoefficient}, and they span a dense subspace, by the points above. This proves the $L^2$-part of the theorem.

%To prove that finite vectors are dense in $C(H)$, we use the trick of approximating a continuous function $f$ by convolutions of continuous functions: Indeed, if $\mu_n$ is a continuous approximation of the identity, as before, $\mu_n \star f \to f$ in $C(H)$. 

%Therefore, it suffices to show that a function of the form $h\star f$, where $h$ and $f$ are continuous, can be approximated uniformly by finite functions. Notice that 
%$$h\star f(x) = \int_H h(g) f(g^{-1}x) dg = \left< h, R_x f^*\right>,$$ where $f^*(g) = \overline{f(g^{-1})}$.

%Let $h_n$ be a sequence of finite functions which converges to $h$ in $L^2(H)$. Then, the functions $R_x f^*$ are bounded uniformly in $x$, and therefore
%$$ h_n\star f(x) = \left< h_n, R_x f^*\right> \to \left< h, R_x f^*\right> = h_n\star f,$$
%uniformly in $x$.

\end{proof}


\begin{remark}
\label{remark-peterweyl-not-isometry}
 If $\pi$ is endowed with an invariant Hilbert norm, so $\pi^*= \bar\pi$, the decomposition \eqref{equation-PeterWeyl} is not an isometry. This will be the subject of the Plancherel formula, Theorem \ref{theorem-Plancherel}.
\end{remark}


\begin{theorem}
\label{theorem-PeterWeyl-general}
 Every Fr\'echet representation $(\pi,V)$ of $H$ contains a dense subspace of finite vectors. In particular, every irreducible Fr\'echet represenation is finite dimensional. Every Hilbert representation of $H$ is the Hilbert space direct sum of irreducibles.
\end{theorem}


\begin{proof}
Let $f_n dh$ be an approximation of the identity by positive, continuous probability measures. Then, given a convex neighborhood $U\subset V$ of zero, and a vector $v\in V$, we have $\pi(f_n dh)\in v+\frac{1}{2}U$, for large $n$, by Proposition \ref{representationtheory-proposition-integral-lcs}. 

Now fix such a large $n$, and choose a sequence $h_j$ of finite functions such that $h_j\to f_n$ in $L^2(H)$. In particular, $h_j\to f_n$ in $L^1(H)$, and the measures $h_j dh$ converge strongly to $f_n dh$. Again by Proposition \ref{representationtheory-proposition-integral-lcs}, we have $\pi(h_j dh)(v)\to \pi(f_n dh)(v)$, hence $\pi(h_j dh)(v)\in v+U$, for large $j$. 


But, for a vector $v\in V$, $\pi(\mu_n)v$ is finite since $\mu_n$ is left-finite. This proves the first claim, and the others follow easily.

\end{proof}




\begin{proposition}
\label{proposition-denseinclusions} 
Assume that $H$ is a compact Lie group (or just a compact group, ignoring mentions of smooth vectors below). We have a sequence of dense inclusions of Fr\'echet spaces:
\begin{equation}
 L^2(H)_{\text{fin}} \subset C^\infty(H) \subset C(H)\subset L^2(H),
\end{equation}
where $~_{\text{fin}}$ denotes left and right finite functions.
\end{proposition}

\begin{proof}
If $H$ is a Lie group, we can show as in the proof of Theorem \ref{theorem-PeterWeyl}, by choosing a smooth approximation of the identity, that any subrepresentation of $L^2(H)$ contains a dense subspace of smooth vectors, and that $L^2(H)_{\text{fin}}$ belongs to the space of smooth functions. 


We then apply Theorem \ref{theorem-PeterWeyl-general} to any of these Fr\'echet spaces, viewed as a representation of the group $H\times H$. 
\end{proof}



\section{The Plancherel formula}
\label{section-Plancherel}

The Plancherel formula expresses a function $f\in L^2(H)$ (using probability Haar measure for the $L^2$-norms throughout) in terms of its \emph{spectral transforms}, which have to be defined as explicit projections onto the summands $\pi^*\otimes \pi$ of the Peter--Weyl theorem. Of course, $f$ decomposes as a convergent sum of its orthogonal projections to those subspaces, but these are not the most natural projections to consider in practice. Instead, the ``natural'' projection is the map
$$ f\mapsto \pi(f dh) \in \text{End}(\pi) = \pi^*\otimes \pi$$
(where $dh$ is the probability Haar measure). 

Hence, the content of the Plancherel formula is the comparison of these ``natural'' projections with the orthogonal ones.

\begin{theorem}
 \label{theorem-Plancherel}
For any $f\in L^2(H)$, we have 
\begin{equation}
 \label{equation-Plancherelformula}
\Vert f\Vert^2 = \sum_\pi \Vert \pi(fdh) \Vert_{HS}^2 \cdot d(\pi),
\end{equation}
 where $\pi$ ranges over all isomorphism classes of irreducible unitary representations of $H$, $d(\pi)$ denotes the dimension of $\pi$, and $\Vert \cdot \Vert_{HS}$ denotes the Hilbert--Schmidt norm on $\text{End}(\pi)$, i.e., the Hilbert norm on $\pi^*\otimes \pi$.
 
 If $f\in C(H)$ can be written as the convolution of two functions in $L^2(H)$ (or a linear combination thereof), then we have 
\begin{equation}
 \label{equation-Plancherelformula-trace}
f(1) = \sum_\pi \text{tr}\left( \pi(fdh) \right) \cdot d(\pi),
\end{equation}
with the right hand side being absolutely convergent.
\end{theorem}

\begin{proof}
 Assume that $f \in L^2(H)$. The right regular action $R(fdh)$ is represented by the kernel $K_f(x,y) = f(x^{-1},y)$, i.e., 
 $$ R(fdh)\Phi(x) = \int \Phi(y) f(x^{-1}y) dy.$$
 
 Calculating the Hilbert--Schmidt norm of this operator we get, on one hand, 
 $$ \Vert R(fdh)\Vert^2_{HS} = \Vert K_f \Vert_{L^2(H\times H)}^2 = \Vert f \Vert^2,$$
 and on the other, by the Peter--Weyl theorem \ref{theorem-PeterWeyl}, 
 $$ \Vert R(fdh)\Vert^2_{HS} = \sum_\pi \dim(\pi^*) \Vert \pi(fdh)\Vert^2_{HS} = \sum_\pi d(\pi) \Vert \pi(fdh)\Vert^2_{HS}.$$
 This proves \eqref{equation-Plancherelformula}.
 
 Now let $f$ be the convolution of two $L^2$-functions: $f=f_1\star f_2$.  
 Then, $f(1) = \left< f_1^*, f_2\right>,$
 where $f_1^*(g) = \overline{f_1 (g^{-1})}$, and $\star$ denotes convolution (=pushforward by the multiplication map $H\times H\to H$).  (We take the linear factor to be the second one in the hermitian inner products.)
 
 By the Plancherel formula just proven, we have (with all sums absolutely convergent)
 $$\left< f_1^*, f_2\right> = \sum_\pi d(\pi) \left< \pi(f_1^*dh ), \pi(f_2 dh) \right>_{HS} = $$
 $$ = \sum_\pi d(\pi) \text{tr}\left( \pi(f_1 dh ) \circ \pi(f_2 dh)\right) = \sum_\pi d(\pi) \text{tr}\left( \pi(f dh ) \right),$$
 where we have used the fact that, for two Hilbert--Schmidt operators $T_1, T_2$, we have $\text{tr}(T_1 \circ T_2) = \left< T_1^*, T_2\right>_{HS}$.  
\end{proof}

\begin{remark}
 \label{remark-traceclass}
If $f = f_1 \star f_2$, so $R(f) = R(f_1)\circ R(f_2)$, the operator $R(f)$, being the composition of two Hilbert--Schmidt operators, is a \emph{trace class operator}, and its trace can be computed in any orthogonormal basis of the Hilbert space. 

Hilbert--Schmidt and trace class operators form ideals in the algebra $B(V)$ of bounded operators on a Hilbert space $V$, let us denote them by $B(V)_2$ and $B(V)_1$, respectively. We have inclusions
$$ B(V)_1\subset B(V)_2 \subset K(V) \subset B(V),$$
where $K(V)$ is the subspace of compact operators. The first two inclusions are dense, and the last one is closed. The space of trace class operators admits a norm, under which
$$ K(V)^* = B(V)_1,$$
$$ B(V)_1^* = B(V).$$
The first equality, restricted to the dense subspace of Hilbert--Schmidt operators in $K(V)$, can be taken as the definition of trace class operators, i.e., an operator $T$ is trace class if
$$ \sup_{S\in B(V)_2, \Vert S\Vert\le 1} |\left< T, S\right>_{HS}| \le \infty,$$
where $\Vert S\Vert$ is the \emph{operator norm}, not the Hilbert--Schmidt norm of $S$, which ensures that the Hilbert--Schmidt pairing extends to a pairing between $B(V)_1$ and the space of compact operators. It can be shown that trace class operators are precisely the compositions of two Hilbert--Schmidt operators.

In practice, there are many situations where a continuous function can be shown to be a convolution of two functions. For example, it is a corollary of the \emph{Dixmier--Malliavin theorem} that if $G$ is a compact Lie group then every smooth function of $G$ is a convolution of two smooth functions, hence the pointwise Plancherel formula applies to smooth functions.

On the other hand, pointwise convergence for general continuous functions fails, even for the example of Fourier series when $H=S^1$!
\end{remark}


\section{Example: Spherical harmonics}
\label{section-spherical-harmonics}

We finish this chapter with a classical example, the decomposition of the space $L^2(S^n)$ into irreducibles for the action of $\text{SO}(n+1)$. Here, $S^n$ is the unit sphere in Euclidean space $\mathbb R^{n+1}$, and $G=\text{SO}(n+1)$ is the special orthogonal group of length-preserving linear transformations of determinant $+1$. We follow the notes \cite{Gallier}.

Here, we work with real-valued functions and real Hilbert spaces; the translation to complex-valued functions is immediate, after tensoring by $\mathbb C$. We let $G$ act on the right on $\mathbb R^{n+1}$, and by fixing a base point we have an isomorphism $S^n = \text{SO}(n)\backslash \text{SO}(n+1)$, which proves (inductively) that $\text{SO}(n)$ is compact.

\begin{lemma}
 \label{lemma-polynomials-dense-onsphere}
Restrictions of polynomials on $\mathbb R^{n+1}$ are dense in $L^2(S^n)$. 
\end{lemma}

\begin{proof}
 Apply the Stone--Weierstrass theorem.
\end{proof}

The restriction map $\mathbb R[\mathbb R^{n+1}] \to L^2(S^n)$ is not injective. For example, on $S^1 = \exp(i\mathbb R)$ we have $x^2 + y^2 = 1$. 

One proves that it is enough to restrict to \emph{harmonic polynomials}, that is, eigenvalues for the Laplacian $\Delta$ on $\mathbb R^{n+1}$. The proof goes as follows: We define an isomorphism $P\mapsto \partial (P)$ between the algebra of polynomials and the algebra of linear differential operators with constant coefficients on $V = \mathbb R^{n+1}$, given in an orthonormal set of coordinates $(x_i)_i$ by $x_i\mapsto \frac{\partial}{\partial x_i}$. (Up to a scalar, this is simply the Fourier transform of a differential operator, when we use the inner product to identify the space $V$ with its dual $V^*$.) Then one easily sees that the pairing 
\begin{equation}
 \label{equation-pairing-homogeneous}
 \left< P , Q\right> = \partial(P) \overline{Q}
\end{equation}
is an inner product on the space $\mathbb R[V]_k$ of homogeneous polynomials of degree $k$, or a hermitian inner product on $\mathbb C[V]_k$.


\begin{lemma}
 \label{lemma-Laplacian-onto}
The Laplace operator
$$ \Delta:\mathbb R[V]_{k+2}  \to \mathbb R[V]_k$$
is surjective for every $k\ge -1$ (setting $\mathbb R[V]_{-1} =0$).  
\end{lemma}

\begin{proof}
 If $Q\in \mathbb R[V]_k$ is orthogonal to the image of $\Delta$ then for every $P\in \mathbb R[V]_{k+2}$ we have
 $$ 0 = \left < Q, \Delta P \right> = \left< \Vert x\Vert^2 Q, P\right>$$
 (by basic properties of Fourier transform),
 hence $\Vert x \Vert^2 Q = 0$, and therefore $Q=0$.
\end{proof} 
 
The same argument shows
\begin{lemma}
 \label{lemma-harmonic-rest}
If $H_{k+2} \subset \mathbb R[V]_{k+2}$ denotes the subspace of harmonic polynomials ($\Delta P=0$), we have an orthogonal decomposition
$$\mathbb R[V]_{k+2} = H_{k+2} \oplus \Vert x\Vert^2 R[V]_k.$$
\end{lemma}

\begin{proof}
 Indeed, if $P \in H_{k+2}$ and $Q\in R[V]_k$, we have 
 $$\left< \Vert x\Vert^2 Q, P\right> =\left < Q, \Delta P \right> =0,$$ 
 which shows that the two subspaces are orthogonal. By \ref{lemma-Laplacian-onto}, their dimensions are complementary; this proves the lemma.
\end{proof}

This shows:
\begin{proposition}
 \label{proposition-harmonic-ontosphere}
 We have an orthogonal decomposition
 $$ R[V]_k = H_k \oplus \Vert x\Vert^2 H_{k-2} \oplus \Vert x\Vert^4 H_{k-4} \oplus \dots.$$
 The restriction of every polynomial to $S^n$ is equal to the restriction of a linear combination of harmonic polynomials.
\end{proposition}

\begin{proof}
 The first statement follows by induction from Lemma \ref{lemma-harmonic-rest}, and the second because $\Vert x\Vert =1$ on the unit sphere.
\end{proof}

Now, if $\Delta_S$ is the Laplacian on $S^n$, and $r = \Vert x\Vert$ is the radial coordinate, the Laplacian on $\mathbb R^{n+1}$ can be written
\begin{equation}
 \label{equation-Laplacian-decomposition}
 \Delta = \frac{1}{r^n} \frac{\partial}{\partial r} \left(r^n \frac{\partial}{\partial r}\right) + \frac{1}{r^2} \Delta_S.
\end{equation}

Hence, 
\begin{lemma}
 \label{lemma-eigenvalue-sphereLaplacian}
If $P\in H_k$, then $P|_{S^n}$ is an eigenvector of the Laplacian $\Delta_S$ with eigenvalue $-k(n+k-1)$.
\end{lemma}

\begin{proof}
 We write $P (r,\theta) = r^k f(\theta)$, with $\theta$ the coordinate on $S^n$, and the result follows from \eqref{equation-Laplacian-decomposition}.
\end{proof}

This leads to the main result:
\begin{theorem}
 \label{theorem-sphericalharmonics}
If $H_k$ denotes the space of harmonic polynomials, homogeneous of degree $k$, on $\mathbb R^{n+1}$, the restriction maps
$$H_k \to L^2(S^n)$$
are injective (allowing us to identify $H_k$ as a subspace of $L^2(S^n)$, and we have an orthogonal direct sum decomposition 
$$ L^2(S^n) = \hat\bigoplus_{k=0}^\infty H_k.$$
This is the decomposition of $L^2(S^n)$ into irreducible representations for the group $\text{SO}(n+1)$.
\end{theorem}

\begin{proof}
 The restriction of a homogeneous polynomial to $S^n$ determines the polynomial, therefore the maps $\mathbb R[\mathbb R]_k \to L^2(S^n)$ (and, a fortiori, their restriction to harmonic polynomials) are injective for every $k$.
 
 The Laplacian $\Delta_S$ is a self-adjoint operator; therefore, its eigenspaces corresponding to distinct eigenvalues are mutually orthogonal. This applies to the spaces $H_k$, by Lemma \ref{lemma-eigenvalue-sphereLaplacian}.
 
 By Lemma  \ref{lemma-polynomials-dense-onsphere}, restrictions of polynomials to $S^n$ are dense, and by Proposition \ref{proposition-harmonic-ontosphere}, those are the same as the restrictions of harmonic polynomials.
 
 The group $G=\text{SO}(n+1)$ preserves the metric on $S^n$, therefore its action on $C^\infty(S^n)$ commutes with the Laplacian. In particular, eigenspaces for $\Delta_S$ are stable under $G$. 
 
 [Proof of irreducibility to be added.]
\end{proof}





\input{chapters}


\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
